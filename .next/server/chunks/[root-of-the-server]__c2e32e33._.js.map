{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 258, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ssgou/Downloads/ATS-resume-checker-main/src/lib/gemini-service.ts"],"sourcesContent":["import { GoogleGenAI } from \"@google/genai\";\n\nexport interface ResumeData {\n  document_type: string;\n  is_resume?: boolean;\n  message?: string;\n  header?: {\n    name: string;\n    email: string;\n    phone: string;\n    location: string;\n    linkedin?: string;\n    website?: string;\n  };\n  sections?: {\n    summary?: string;\n    experience: Array<{\n      title: string;\n      company: string;\n      duration: string;\n      description: string;\n      achievements: string[];\n    }>;\n    education: Array<{\n      degree: string;\n      institution: string;\n      year: string;\n      gpa?: string;\n    }>;\n    skills: {\n      technical: string[];\n      soft: string[];\n      languages?: string[];\n    };\n    certifications?: Array<{\n      name: string;\n      issuer: string;\n      year: string;\n    }>;\n  };\n  ats_analysis?: {\n    score: number;\n    issues: string[];\n    recommendations: string[];\n    keyword_matches: string[];\n    missing_keywords: string[];\n  };\n  pro_suggestions?: {\n    categories: Array<{\n      category: string;\n      priority: \"Critical\" | \"High\" | \"Medium\" | \"Low\";\n      suggestions: string[];\n      impact: string;\n    }>;\n    summary: {\n      total_categories: number;\n      total_suggestions: number;\n      potential_score_increase: number;\n    };\n  };\n}\n\nexport interface ATSAnalysisResult {\n  success: boolean;\n  data?: ResumeData;\n  error?: string;\n  raw_text?: string;\n}\n\nexport class GeminiService {\n  private ai: GoogleGenAI;\n\n  constructor() {\n    const apiKey = process.env.NEXT_PUBLIC_GEMINI_API_KEY;\n    if (!apiKey) {\n      throw new Error(\"NEXT_PUBLIC_GEMINI_API_KEY is not set\");\n    }\n    this.ai = new GoogleGenAI({ apiKey });\n  }\n\n  // Simple sleep helper for backoff delays\n  private async sleep(milliseconds: number): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve, milliseconds));\n  }\n\n  // Robust generator with retries and fallback models for transient 5xx overloads\n  private async generateWithRetries(\n    contents: Array<any>,\n    models: string[] = [\"gemini-2.5-flash\", \"gemini-1.5-flash\"],\n    maxAttemptsPerModel: number = 3\n  ): Promise<any> {\n    const isTransient = (error: unknown): boolean => {\n      const anyErr = error as any;\n      const status = anyErr?.status ?? anyErr?.code ?? anyErr?.error?.code;\n      const message: string = (anyErr?.message || \"\").toString();\n      // Treat 5xx or UNAVAILABLE as transient\n      return (\n        status === 503 || status === 502 || status === 500 ||\n        message.includes(\"UNAVAILABLE\") || message.includes(\"overloaded\")\n      );\n    };\n\n    // Iterate models in order, retrying each on transient errors with exponential backoff\n    for (const model of models) {\n      let attempt = 0;\n      while (attempt < maxAttemptsPerModel) {\n        try {\n          return await this.ai.models.generateContent({ model, contents });\n        } catch (error) {\n          attempt += 1;\n          if (!isTransient(error) || attempt >= maxAttemptsPerModel) {\n            // If not transient or attempts exhausted for this model, either try next model or rethrow\n            if (models.indexOf(model) === models.length - 1) {\n              throw error;\n            }\n            break; // move to next model\n          }\n          const backoffMs = Math.min(8000, 1000 * Math.pow(2, attempt - 1));\n          await this.sleep(backoffMs);\n        }\n      }\n    }\n\n    // Should not reach here; throw a generic error just in case\n    throw new Error(\"AI service temporarily unavailable. Please try again later.\");\n  }\n\n  async processResumeWithGemini(\n    base64Data: string,\n    fileType: string,\n    fileName: string\n  ): Promise<ATSAnalysisResult> {\n    try {\n      const today = new Date();\n      const currentYear = today.getFullYear();\n      const currentMonth = today.getMonth() + 1; // getMonth() returns 0-11\n\n      const prompt = `\n        FIRST: Determine if this document is actually a resume or CV. Look for:\n        - Personal contact information (name, email, phone)\n        - Work experience or employment history\n        - Education background\n        - Skills or qualifications\n        - Professional summary or objective\n        \n        If this is NOT a resume/CV (e.g., it's a letter, invoice, article, etc.), return:\n        {\n          \"document_type\": \"not_resume\",\n          \"is_resume\": false,\n          \"message\": \"This document does not appear to be a resume or CV. Please upload a resume document for analysis.\"\n        }\n\n        If this IS a resume/CV, analyze it and extract information in the following structured format:\n\n        RESUME ANALYSIS:\n        Extract all sections and provide ATS compatibility analysis.\n\n        Return the data in JSON format with this structure:\n        {\n          \"document_type\": \"resume\",\n          \"is_resume\": true,\n          \"header\": {\n            \"name\": \"Full Name\",\n            \"email\": \"email@example.com\",\n            \"phone\": \"phone number\",\n            \"location\": \"city, state\",\n            \"linkedin\": \"check for linkedin url in the document and return it if present\",\n            \"website\": \"check for personal website in the document and return it if present\"\n            \"github\": \"check for github word and check whether it is a hyperlink and return url if it is a hyper link\"\n          },\n          \"sections\": {\n            \"summary\": \"professional summary if present\",\n            \"experience\": [\n              {\n                \"title\": \"Job Title\",\n                \"company\": \"Company Name\",\n                \"duration\": \"Duration (e.g., 2020-2022)\",\n                \"description\": \"Job description\",\n                \"achievements\": [\"achievement 1\", \"achievement 2\"]\n              }\n            ],\n            \"education\": [\n              {\n                \"degree\": \"Degree Name\",\n                \"institution\": \"Institution Name\",\n                \"year\": \"Graduation Year\",\n                \"gpa\": \"GPA if mentioned\"\n              }\n            ],\n            \"skills\": {\n              \"technical\": [\"skill1\", \"skill2\"],\n              \"soft\": [\"soft skill1\", \"soft skill2\"],\n              \"languages\": [\"language1\", \"language2\"]\n            },\n            \"certifications\": [\n              {\n                \"name\": \"Certification Name\",\n                \"issuer\": \"Issuing Organization\",\n                \"year\": \"Year obtained\"\n              }\n            ]\n          },\n          \"ats_analysis\": {\n            \"score\": 85,\n            \"issues\": [\"issue1\", \"issue2\"],\n            \"recommendations\": [\"recommendation1\", \"recommendation2\"],\n            \"keyword_matches\": [\"keyword1\", \"keyword2\"],\n            \"missing_keywords\": [\"missing1\", \"missing2\"]\n          },\n          \"pro_suggestions\": {\n            \"categories\": [\n              {\n                \"category\": \"Header Optimization\",\n                \"priority\": \"High\",\n                \"suggestions\": [\n                  \"Move contact information to the very top of the resume\",\n                  \"Use a professional email format (firstname.lastname@email.com)\",\n                  \"Include a professional LinkedIn URL\",\n                  \"Add a location that matches job requirements\"\n                ],\n                \"impact\": \"Improves ATS parsing by 25%\"\n              },\n              {\n                \"category\": \"Experience Section\",\n                \"priority\": \"High\",\n                \"suggestions\": [\n                  \"Use action verbs at the beginning of each bullet point\",\n                  \"Include quantifiable achievements with numbers and percentages\",\n                  \"Add industry-specific keywords naturally\",\n                  \"Keep bullet points to 1-2 lines maximum\"\n                ],\n                \"impact\": \"Increases keyword matching by 40%\"\n              },\n              {\n                \"category\": \"Skills Section\",\n                \"priority\": \"Medium\",\n                \"suggestions\": [\n                  \"Create separate sections for technical and soft skills\",\n                  \"Include proficiency levels (Beginner, Intermediate, Expert)\",\n                  \"Add emerging technologies relevant to your field\",\n                  \"Use industry-standard skill names\"\n                ],\n                \"impact\": \"Boosts skill recognition by 30%\"\n              },\n              {\n                \"category\": \"Education & Certifications\",\n                \"priority\": \"Medium\",\n                \"suggestions\": [\n                  \"Add graduation dates in MM/YYYY format\",\n                  \"Include relevant certifications with expiration dates\",\n                  \"List education in reverse chronological order\",\n                  \"Add GPA if above 3.5\"\n                ],\n                \"impact\": \"Enhances qualification matching by 20%\"\n              },\n              {\n                \"category\": \"Formatting & Structure\",\n                \"priority\": \"High\",\n                \"suggestions\": [\n                  \"Use standard fonts (Arial, Calibri, Times New Roman)\",\n                  \"Remove graphics, tables, and complex formatting\",\n                  \"Use simple bullet points instead of custom symbols\",\n                  \"Ensure consistent date formatting throughout\"\n                ],\n                \"impact\": \"Improves parsing accuracy by 35%\"\n              },\n              {\n                \"category\": \"Keyword Optimization\",\n                \"priority\": \"Critical\",\n                \"suggestions\": [\n                  \"Add missing industry keywords identified in analysis\",\n                  \"Include job title variations\",\n                  \"Add technology stack keywords\",\n                  \"Include soft skills that match job requirements\"\n                ],\n                \"impact\": \"Increases ATS score by 15-25 points\"\n              }\n            ],\n            \"summary\": {\n              \"total_categories\": 6,\n              \"total_suggestions\": 24,\n              \"potential_score_increase\": 25\n            }\n          }\n        }\n\n        IMPORTANT DATE VALIDATION RULES:\n        - Current date is ${currentYear}-${currentMonth\n        .toString()\n        .padStart(2, \"0\")}\n        - \"Present\" or \"Current\" in dates is valid and should not be flagged as future\n        - \"Dec 2024 to present\" is valid if we're in 2024\n        - Only flag dates as future if they are clearly beyond the current date\n        - Consider month abbreviations (Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec)\n\n        ATS Analysis Guidelines:\n        - Score: 0-100 based on ATS compatibility\n        - Issues: List specific problems found, but be careful with date validation\n        - Recommendations: Provide actionable improvement suggestions\n        - Keywords: Extract relevant technical and industry keywords\n        - Missing keywords: Suggest important keywords that could be added\n\n        Pro Suggestions Guidelines:\n        - Only provide if document is confirmed to be a resume/CV\n        - Analyze the resume and provide specific, actionable suggestions for each category\n        - Prioritize suggestions based on their impact on ATS compatibility\n        - Focus on practical, implementable changes\n        - Consider industry best practices and current ATS requirements\n      `;\n\n      const contents = [\n        { text: prompt },\n        {\n          inlineData: {\n            mimeType:\n              fileType === \"application/pdf\" ? \"application/pdf\" : \"image/jpeg\",\n            data: base64Data,\n          },\n        },\n      ];\n\n      const response = await this.generateWithRetries(contents, [\n        \"gemini-2.5-flash\",\n        \"gemini-1.5-flash\",\n      ]);\n\n      const responseText = response.text || \"\";\n      let structuredData: ResumeData;\n      try {\n        // Try to parse JSON response\n        const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n          structuredData = JSON.parse(jsonMatch[0]);\n        } else {\n          throw new Error(\"No valid JSON found\");\n        }\n      } catch (parseError) {\n        // Fallback parsing with default pro suggestions\n        structuredData = {\n          document_type: \"resume\",\n          is_resume: true,\n          header: {\n            name: \"Extracted from document\",\n            email: \"\",\n            phone: \"\",\n            location: \"\",\n          },\n          sections: {\n            experience: [],\n            education: [],\n            skills: {\n              technical: [],\n              soft: [],\n            },\n          },\n          ats_analysis: {\n            score: 50,\n            issues: [\"Unable to parse structured data\"],\n            recommendations: [\"Please check the document format\"],\n            keyword_matches: [],\n            missing_keywords: [],\n          },\n          pro_suggestions: {\n            categories: [\n              {\n                category: \"Header Optimization\",\n                priority: \"High\",\n                suggestions: [\n                  \"Move contact information to the very top of the resume\",\n                  \"Use a professional email format\",\n                  \"Include a professional LinkedIn URL\",\n                ],\n                impact: \"Improves ATS parsing by 25%\",\n              },\n              {\n                category: \"Experience Section\",\n                priority: \"High\",\n                suggestions: [\n                  \"Use action verbs at the beginning of each bullet point\",\n                  \"Include quantifiable achievements\",\n                  \"Add industry-specific keywords naturally\",\n                ],\n                impact: \"Increases keyword matching by 40%\",\n              },\n            ],\n            summary: {\n              total_categories: 2,\n              total_suggestions: 6,\n              potential_score_increase: 15,\n            },\n          },\n        };\n      }\n\n      return {\n        success: true,\n        data: structuredData,\n        raw_text: responseText,\n      };\n    } catch (error) {\n      console.error(\"Error processing resume:\", error);\n      const anyErr = error as any;\n      const status = anyErr?.status ?? anyErr?.code ?? anyErr?.error?.code;\n      const friendly =\n        status === 503\n          ? \"The AI model is temporarily overloaded. We are retrying automatically; please try again in a moment if it persists.\"\n          : anyErr?.message || \"Unknown error occurred\";\n      return {\n        success: false,\n        error: friendly,\n        raw_text: \"\",\n      };\n    }\n  }\n\n  async analyzeATSCompatibility(\n    resumeData: ResumeData,\n    jobKeywords: string[] = []\n  ): Promise<ATSAnalysisResult> {\n    try {\n      const prompt = `\n        You are an expert in Applicant Tracking Systems (ATS) and resume parsing.\n        \n        Your task is to analyze the given resume or CV data for ATS compatibility and provide a detailed evaluation.\n        \n        ====================\n        Resume Data:\n        ${JSON.stringify(resumeData, null, 2)}\n        ====================\n        \n        Job Description Keywords (if provided): ${jobKeywords.join(\", \")}\n        \n        Please perform a comprehensive analysis and return the following in JSON format under a key called \"ats_analysis\":\n        \n        1. **ATS Compatibility Score** (0-100): A numeric score based on how well the resume follows ATS best practices (formatting, structure, keyword usage, section naming, etc.).\n        \n        2. **Structural Completeness Check**:\n           - Confirm presence of key sections:\n             - Contact Information\n             - Professional Summary or Objective\n             - Work Experience\n             - Skills\n             - Education\n             - Certifications (if available)\n           - Note if any major section is missing.\n        \n        3. **Formatting Issues** (if any):\n           - Usage of tables, columns, graphics, images, or non-standard fonts\n           - File type concerns (PDF vs DOCX)\n           - Unscannable content (e.g., in headers/footers)\n        \n        4. **Keyword Matching Analysis**:\n           - Highlight which job-related keywords are present\n           - Identify important missing keywords\n           - Provide a match percentage based on provided job keywords\n        \n        5. **Detected Issues**:\n           - List all potential ATS-blocking or ATS-confusing elements\n        \n        6. **Actionable Recommendations**:\n           - Give specific and practical suggestions to improve ATS compatibility\n           - Tailor suggestions based on detected formatting or content issues\n           - Highlight enhancements in keyword optimization\n        \n        7. **Summary Verdict**:\n           - Clear final judgment: \"ATS-Friendly\", \"Moderately ATS-Compatible\", or \"Not ATS-Compatible\"\n           - Brief reasoning based on the overall analysis\n        \n        Make sure your analysis is accurate, concise, and informative. Return only the JSON with the \"ats_analysis\" section updated accordingly.\n        `;\n\n      const response = await this.generateWithRetries([{ text: prompt }], [\n        \"gemini-2.5-flash\",\n        \"gemini-1.5-flash\",\n      ]);\n\n      console.log(\"Response: \", response);\n\n      let enhancedData: ResumeData;\n      try {\n        const responseText = response.text || \"\";\n        const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n          enhancedData = JSON.parse(jsonMatch[0]);\n        } else {\n          // Fallback: enhance existing data\n          enhancedData = {\n            ...resumeData,\n            ats_analysis: {\n              ...resumeData.ats_analysis,\n              score: Math.min(100, (resumeData.ats_analysis?.score || 50) + 5),\n              recommendations: [\n                ...(resumeData.ats_analysis?.recommendations || []),\n                \"Consider tailoring keywords to specific job postings\",\n              ],\n              issues: resumeData.ats_analysis?.issues || [],\n              keyword_matches: resumeData.ats_analysis?.keyword_matches || [],\n              missing_keywords: resumeData.ats_analysis?.missing_keywords || [],\n            },\n          };\n        }\n      } catch (parseError) {\n        enhancedData = resumeData;\n      }\n\n      return {\n        success: true,\n        data: enhancedData,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error:\n          error instanceof Error ? error.message : \"Unknown error occurred\",\n      };\n    }\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 696, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ssgou/Downloads/ATS-resume-checker-main/src/app/api/process-resume/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { GeminiService } from \"@/lib/gemini-service\";\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData();\n    const file = formData.get(\"file\") as File;\n\n    if (!file) {\n      return NextResponse.json({ error: \"No file provided\" }, { status: 400 });\n    }\n\n    // Validate file type\n    const validTypes = [\n      \"application/pdf\",\n      \"application/msword\",\n      \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n    ];\n\n    if (!validTypes.includes(file.type)) {\n      return NextResponse.json(\n        { error: \"Invalid file type. Please upload a PDF, DOC, or DOCX file.\" },\n        { status: 400 }\n      );\n    }\n\n    // Validate file size (max 10MB)\n    const maxSize = 10 * 1024 * 1024; // 10MB\n    if (file.size > maxSize) {\n      return NextResponse.json(\n        {\n          error: \"File size too large. Please upload a file smaller than 10MB.\",\n        },\n        { status: 400 }\n      );\n    }\n\n    // Convert file to base64\n    const arrayBuffer = await file.arrayBuffer();\n    const buffer = Buffer.from(arrayBuffer);\n    const base64Data = buffer.toString(\"base64\");\n\n    // Process with Gemini AI\n    const geminiService = new GeminiService();\n    const result = await geminiService.processResumeWithGemini(\n      base64Data,\n      file.type,\n      file.name\n    );\n\n    if (!result.success) {\n      return NextResponse.json(\n        { error: result.error || \"Failed to process resume\" },\n        { status: 500 }\n      );\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: result.data,\n      message: \"Resume processed successfully\",\n    });\n  } catch (error) {\n    console.error(\"Error processing resume:\", error);\n    return NextResponse.json(\n      { error: \"Internal server error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,IAAI,CAAC,MAAM;YACT,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,qBAAqB;QACrB,MAAM,aAAa;YACjB;YACA;YACA;SACD;QAED,IAAI,CAAC,WAAW,QAAQ,CAAC,KAAK,IAAI,GAAG;YACnC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA6D,GACtE;gBAAE,QAAQ;YAAI;QAElB;QAEA,gCAAgC;QAChC,MAAM,UAAU,KAAK,OAAO,MAAM,OAAO;QACzC,IAAI,KAAK,IAAI,GAAG,SAAS;YACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;YACT,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,yBAAyB;QACzB,MAAM,cAAc,MAAM,KAAK,WAAW;QAC1C,MAAM,SAAS,OAAO,IAAI,CAAC;QAC3B,MAAM,aAAa,OAAO,QAAQ,CAAC;QAEnC,yBAAyB;QACzB,MAAM,gBAAgB,IAAI,iIAAA,CAAA,gBAAa;QACvC,MAAM,SAAS,MAAM,cAAc,uBAAuB,CACxD,YACA,KAAK,IAAI,EACT,KAAK,IAAI;QAGX,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,OAAO,KAAK,IAAI;YAA2B,GACpD;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM,OAAO,IAAI;YACjB,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}