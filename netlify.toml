# Netlify configuration for Career Companion

[build]
# Build command - Next.js 15 compatible
# Note: npm ci ensures exact versions from package-lock.json
command = "npm ci && npm run build"
# Publish directory where Next.js builds to
publish = ".next"

[build.environment]
# Node version - set to 18 LTS as per .nvmrc
NODE_VERSION = "18.20.8"
# Next.js production mode
NODE_ENV = "production"

# Environment variables - set these in Netlify UI or in .env.production
# NEXT_PUBLIC_GEMINI_API_KEY = "your-api-key"

# Install Netlify plugin for Next.js
[[plugins]]
package = "@netlify/plugin-nextjs"

# Security headers
[[headers]]
for = "/*"
[headers.values]
X-Content-Type-Options = "nosniff"
X-Frame-Options = "DENY"
X-XSS-Protection = "1; mode=block"
Referrer-Policy = "strict-origin-when-cross-origin"
Permissions-Policy = "geolocation=(), microphone=(), camera=()"

# Cache headers for static assets
[[headers]]
for = "/_next/static/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/public/*"
[headers.values]
Cache-Control = "public, max-age=3600"

# Disable caching for HTML files
[[headers]]
for = "/*.html"
[headers.values]
Cache-Control = "public, max-age=0, must-revalidate"
